{"remainingRequest":"D:\\我的项目\\纪检项目\\byqc\\node_modules\\thread-loader\\dist\\cjs.js!D:\\我的项目\\纪检项目\\byqc\\node_modules\\babel-loader\\lib\\index.js!D:\\我的项目\\纪检项目\\byqc\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\我的项目\\纪检项目\\byqc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\我的项目\\纪检项目\\byqc\\src\\views\\AddInfo\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\我的项目\\纪检项目\\byqc\\src\\views\\AddInfo\\index.vue","mtime":1578879853466},{"path":"D:\\我的项目\\纪检项目\\byqc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检项目\\byqc\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检项目\\byqc\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检项目\\byqc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检项目\\byqc\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport qs from \"qs\";\nimport Breadcrumb from \"@/components/Breadcrumb\";\n\nfunction clearNoNum(obj) {\n  //先把非数字的都替换掉，除了数字和.\n  obj.value = obj.value.replace(/[^\\d.]/g, \"\"); //保证只有出现一个.而没有多个.\n\n  obj.value = obj.value.replace(/\\.{2,}/g, \".\"); //必须保证第一个为数字而不是.\n\n  obj.value = obj.value.replace(/^\\./g, \"\"); //保证.只出现一次，而不能出现两次以上\n\n  obj.value = obj.value.replace(\".\", \"$#$\").replace(/\\./g, \"\").replace(\"$#$\", \".\"); //只能输入两个小数\n\n  obj.value = obj.value.replace(/^(\\-)*(\\d+)\\.(\\d\\d).*$/, '$1$2.$3');\n}\n\nexport default {\n  name: \"AddInfo\",\n  props: {},\n  data: function data() {\n    return {\n      // exportids: \"\",\n      redpicimg: \"\",\n      //给后台传值\n      redimg: \"\",\n      //不带域名的图片路径\n      showinput: true,\n      //工作单位查看时显示\n      disabled: false,\n      exportbtn: false,\n      //导出按钮\n      labelWidth: \"105px\",\n      form: {\n        redBottomPhoto: \"\",\n        //图片\n        name: \"\",\n        //姓名\n        sex: \"\",\n        //性别\n        nation: \"\",\n        //民族\n        nativePlace: \"\",\n        //籍贯\n        birthday: \"\",\n        //生日\n        idCard: \"\",\n        //身份证号\n        politicsStatus: \"\",\n        //政治面貌\n        educationBackground: \"\",\n        //学历\n        maritalStatus: \"\",\n        //婚姻状况\n        partyTime: \"\",\n        //入党时间\n        workTime: \"\",\n        //工作时间\n        companyName: \"\",\n        companyNameid: \"\",\n        \"office.name\": \"\",\n        //工作单位id\n        workingState: \"\",\n        //在职情况  新增\n        presentOccupation: \"\",\n        //现任职务\n        jobLevel: \"\",\n        //职务级别\n        incumbentTime: \"\",\n        //现任职务时间\n        personnelcategory: \"\",\n        //人员类型\n        titleJobs: \"\",\n        //职称\n        titleJobsLevel: \"\",\n        //职称级别\n        isCPPCCMemberOrNot: \"\",\n        //是否是政协委员\n        isNPCDEputiesOrNot: \"\",\n        //是否人大代表\n        isPartyRepresentativeOrNot: \"\",\n        //是否党代表\n        // ===========新增两个是否===========\n        isCommunistPartyMember: \"\",\n        //是否市委委员\n        isCityCommissionPartyMember: \"\",\n        //是否市纪委委员\n        // ==================================\n        presentAddress: \"\",\n        //现住址\n        phone: \"\",\n        //联系电话\n        personalResume: \"\",\n        //个人工作简历\n        rewardsAndPunishment: \"\",\n        //奖惩情况\n        otherrelevantinformation: \"\" //其他相关情况\n\n      },\n      rules: {\n        // redBottomPhoto: [\n        //   { required: true, message: \"请上传头像\", trigger: \"blur\" }\n        // ],\n        name: [{\n          required: true,\n          message: \"请填写姓名\",\n          trigger: \"blur\"\n        }],\n        companyName: [{\n          required: true,\n          message: \"请选择单位名称\",\n          trigger: \"blur\"\n        }],\n        presentOccupation: [{\n          required: true,\n          message: \"请填写现任职务\",\n          trigger: \"blur\"\n        }] // sex: [{ required: true, message: \"请选择性别\", trigger: \"blur\" }],\n        // nation: [{ required: true, message: \"请选择民族\", trigger: \"blur\" }],\n        // nativePlace: [\n        //   { required: true, message: \"请输入籍贯\", trigger: \"blur\" }\n        // ],\n        // birthday: [\n        //   { required: true, message: \"请选择出生日期\", trigger: \"blur\" }\n        // ],\n        // educationBackground: [\n        //   { required: true, message: \"请选择学历\", trigger: \"blur\" }\n        // ],\n        // maritalStatus: [\n        //   { required: true, message: \"请选择婚姻状况\", trigger: \"blur\" }\n        // ],\n        // idCard: [\n        //   { required: true, message: \"请输入身份证号\", trigger: \"blur\" }\n        // ],\n        // workTime: [\n        //   { required: true, message: \"请选择参加工作时间\", trigger: \"blur\" }\n        // ],\n        // workTime: [\n        //   { required: true, message: \"请选择参加工作时间\", trigger: \"blur\" }\n        // ],\n        // workingState: [\n        //   { required: true, message: \"请选择在职情况\", trigger: \"blur\" }\n        // ],\n        // jobLevel: [\n        //   { required: true, message: \"请选择职务级别\", trigger: \"blur\" }\n        // ],\n        // incumbentTime: [\n        //   { required: true, message: \"请选择现任作时间\", trigger: \"blur\" }\n        // ],\n        // personnelcategory: [\n        //   { required: true, message: \"请选择人员类型\", trigger: \"blur\" }\n        // ],\n        // titleJobs: [{ required: true, message: \"请输入职称\", trigger: \"blur\" }],\n        // titleJobsLevel: [\n        //   { required: true, message: \"请选择职称级别\", trigger: \"blur\" }\n        // ],\n        // isCPPCCMemberOrNot: [\n        //   { required: true, message: \"请选择是否政协委员\", trigger: \"blur\" }\n        // ],\n        // isNPCDEputiesOrNot: [\n        //   { required: true, message: \"请选择是否人大代表\", trigger: \"blur\" }\n        // ],\n        // isPartyRepresentativeOrNot: [\n        //   { required: true, message: \"请选择是否党代表\", trigger: \"blur\" }\n        // ],\n        // presentAddress: [\n        //   { required: true, message: \"请输入现住址\", trigger: \"blur\" }\n        // ],\n        // phone: [{ required: true, message: \"请输入联系电话\", trigger: \"blur\" }],\n        // 新增两个是否\n        // isCommunistPartyMember: [\n        //   { required: true, message: \"请选择是否市委委员\", trigger: \"blur\" }\n        // ],\n        // isCityCommissionPartyMember: [\n        //   { required: true, message: \"请选择是否市纪委委员\", trigger: \"blur\" }\n        // ],\n\n      },\n      //家庭成员\n      familyMembers: [{\n        appellation: \"\",\n        //称谓\n        name: \"\",\n        //姓名\n        politicsStatus: \"\",\n        //政治面貌\n        presentOccupation: \"\",\n        //现任职务\n        companyName: \"\",\n        //工作单位\n        age: \"\",\n        //年龄\n        id: \"\"\n      }],\n      //个人及配偶、共同生活的子女拥有的房产情况\n      housingSituations: [{\n        serialNumber: \"\",\n        roomNumber: \"\",\n        coveredArea: \"\",\n        purchasingDate: \"\",\n        purchasePrice: \"\",\n        propertyOwner: \"\",\n        location: \"\",\n        id: \"\"\n      }],\n      showinputcompanyName: true,\n      //表格高度\n      tableHeight: \"50vh\",\n      sexlist: [],\n      //性别数组\n      politicallist: [],\n      //政治面貌数组\n      degreelist: [],\n      //学历数组\n      marriagelist: [],\n      //婚姻数组\n      dutyRankList: [],\n      //职务级别\n      Personneltype: [],\n      //人员类型\n      isif: [],\n      //是否选择下拉框\n      unitslist: [],\n      //级联选择\n      zhichengjibie: [],\n      //职称级别\n      workingStateList: [],\n      //在职情况 新增\n      // 民族\n      nationalities: [\"汉族\", \"蒙古族\", \"回族\", \"藏族\", \"维吾尔族\", \"苗族\", \"彝族\", \"壮族\", \"布依族\", \"朝鲜族\", \"满族\", \"侗族\", \"瑶族\", \"白族\", \"土家族\", \"哈尼族\", \"哈萨克族\", \"傣族\", \"黎族\", \"傈僳族\", \"佤族\", \"畲族\", \"高山族\", \"拉祜族\", \"水族\", \"东乡族\", \"纳西族\", \"景颇族\", \"柯尔克孜族\", \"土族\", \"达斡尔族\", \"仫佬族\", \"羌族\", \"布朗族\", \"撒拉族\", \"毛南族\", \"仡佬族\", \"锡伯族\", \"阿昌族\", \"普米族\", \"塔吉克族\", \"怒族\", \"乌孜别克族\", \"俄罗斯族\", \"鄂温克族\", \"德昂族\", \"保安族\", \"裕固族\", \"京族\", \"塔塔尔族\", \"独龙族\", \"鄂伦春族\", \"赫哲族\", \"门巴族\", \"珞巴族\", \"基诺族\"]\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    document.title = \"个人信息\";\n    var that = this; //在职情况 新增\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + 'web/dict',\n      data: {\n        type: 'working_state'\n      },\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == '-1') {\n        that.workingStateList = res.data.body.dictValueList;\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //性别\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + \"web/dict\",\n      data: {\n        type: \"sex\"\n      },\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == \"-1\") {\n        res.data.body.dictValueList.map(function (list) {\n          that.sexlist.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //政治面貌\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + \"web/dict\",\n      data: {\n        type: \"politics_status\"\n      },\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == \"-1\") {\n        res.data.body.dictValueList.map(function (list) {\n          that.politicallist.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //学历\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + \"web/dict\",\n      data: {\n        type: \"education_background\"\n      },\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == \"-1\") {\n        res.data.body.dictValueList.map(function (list) {\n          that.degreelist.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //婚姻\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + \"web/dict\",\n      data: {\n        type: \"marital_status\"\n      },\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == \"-1\") {\n        res.data.body.dictValueList.map(function (list) {\n          that.marriagelist.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //职务级别\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + \"web/dict\",\n      data: {\n        type: \"job_level\"\n      },\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == \"-1\") {\n        res.data.body.dictValueList.map(function (list) {\n          that.dutyRankList.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //人员类型\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + \"web/dict\",\n      data: {\n        type: \"personne_icategory\"\n      },\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == \"-1\") {\n        res.data.body.dictValueList.map(function (list) {\n          that.Personneltype.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //是否是政协委员\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + \"web/dict\",\n      data: {\n        type: \"yes_no\"\n      },\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == \"-1\") {\n        res.data.body.dictValueList.map(function (list) {\n          that.isif.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //职称级别\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + \"web/dict\",\n      data: {\n        type: \"title_jobs_level\"\n      },\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == \"-1\") {\n        res.data.body.dictValueList.map(function (list) {\n          that.zhichengjibie.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    });\n  },\n  mounted: function mounted() {\n    //updatas 0-修改  2-新增     1-查看\n    this.disabled = this.$route.query.updatas == 1 ? true : false;\n    this.showinput = this.$route.query.updatas == 2 || this.$route.query.updatas == 0 ? false : true;\n    this.showinputcompanyName = this.$route.query.updatas == 2 ? false : true;\n    this.exportbtn = this.$route.query.updatas == 1 ? true : false;\n    var id = this.$route.query.id; //参数id\n\n    if (id) {\n      var objs = {\n        userId: JSON.parse(localStorage.getItem(\"userinfo\")).isd,\n        id: id\n      };\n      this.init(objs);\n    }\n\n    this.initunits();\n  },\n  methods: {\n    indexinfo: function indexinfo(value) {\n      return value + 1 > 9 ? value + 1 : \"0\" + (value + 1);\n    },\n    //保存\n    savebtns: function savebtns(formName) {\n      var _this2 = this;\n\n      var that = this;\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          var requestform = {\n            redBottomPhoto: that.redimg == \"\" ? that.redpicimg : that.redimg,\n            //图片\n            name: that.form.name,\n            //姓名\n            sex: that.form.sex,\n            //性别\n            nation: that.form.nation,\n            //民族\n            nativePlace: that.form.nativePlace,\n            //籍贯\n            birthday: that.form.birthday,\n            //生日\n            idCard: that.form.idCard,\n            //身份证号\n            politicsStatus: that.form.politicsStatus,\n            //政治面貌\n            educationBackground: that.form.educationBackground,\n            //学历\n            maritalStatus: that.form.maritalStatus,\n            //婚姻状况\n            partyTime: that.form.partyTime,\n            //入党时间\n            workTime: that.form.workTime,\n            //工作时间  \n            // companyName: that.form.companyName,  \n            \"office.id\": typeof that.form.companyName == 'string' ? that.form.companyNameid : that.form.companyName[that.form.companyName.length - 1],\n            //工作单位id\n            workingState: that.form.workingState,\n            //在职情况\n            presentOccupation: that.form.presentOccupation,\n            //现任职务\n            jobLevel: that.form.jobLevel,\n            //职务级别\n            incumbentTime: that.form.incumbentTime,\n            //现任职务时间\n            personnelcategory: that.form.personnelcategory,\n            //人员类型\n            titleJobs: that.form.titleJobs,\n            //职称\n            titleJobsLevel: that.form.titleJobsLevel,\n            //职称级别\n            isCPPCCMemberOrNot: that.form.isCPPCCMemberOrNot,\n            //是否是政协委员\n            isNPCDEputiesOrNot: that.form.isNPCDEputiesOrNot,\n            //是否人大代表\n            isPartyRepresentativeOrNot: that.form.isPartyRepresentativeOrNot,\n            //是否党代表\n            // ================================================================================\n            isCommunistPartyMember: that.form.isCommunistPartyMember,\n            //是否市委委员\n            isCityCommissionPartyMember: that.form.isCityCommissionPartyMember,\n            //是否市纪委委员\n            // ================================================================================\n            presentAddress: that.form.presentAddress,\n            //现住址\n            phone: that.form.phone,\n            //联系电话\n            personalResume: that.form.personalResume,\n            //个人工作简历\n            rewardsAndPunishment: that.form.rewardsAndPunishment,\n            //奖惩情况\n            otherrelevantinformation: that.form.otherrelevantinformation,\n            //其他相关情况\n            id: that.form.id,\n            userId: JSON.parse(localStorage.getItem(\"userinfo\")).isd // familyMembers:that.familyMembers,\n            // housingSituations:that.housingSituations,\n            // familyMembers: JSON.stringify(that.familyMembers),\n            // housingSituations: JSON.stringify(that.housingSituations)\n\n          }; // console.log(that.form.companyNameid)\n          // console.log(requestform)\n          // console.log(that.showinputcompanyName)\n\n          _this2.$ajax({\n            method: \"POST\",\n            url: that.globals.requesturl + \"web/personnel/save\",\n            data: requestform,\n            headers: {\n              \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            transformRequest: [function (data) {\n              return qs.stringify(data);\n            }]\n          }).then(function (res) {\n            if (res.data.errorCode == \"-1\") {\n              var familyhousinlist = {\n                familyMembers: JSON.stringify(that.familyMembers),\n                housingSituations: JSON.stringify(that.housingSituations),\n                userId: JSON.parse(localStorage.getItem(\"userinfo\")).isd,\n                personnelId: res.data.body.id\n              }; // let josnfoem = JSON.stringify(familyhousinlist)\n\n              _this2.$ajax({\n                method: \"POST\",\n                url: that.globals.requesturl + \"web/personnel/saveList\",\n                data: familyhousinlist,\n                headers: {\n                  \"Content-Type\": \"application/x-www-form-urlencoded\"\n                },\n                transformRequest: [function (data) {\n                  return qs.stringify(data);\n                }]\n              }).then(function (result) {\n                if (res.data.errorCode == \"-1\") {\n                  _this2.$message.success(res.data.msg);\n\n                  _this2.$router.go(-1);\n                } else {\n                  _this2.$message.error(res.data.msg);\n                }\n              });\n            } else {\n              _this2.$message.error(res.data.msg);\n            }\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    //添加个人及配偶、共同生活的子女拥有的房产情况   companyName.id\n    housingbtn: function housingbtn() {\n      this.housingSituations.push({\n        roomNumber: \"\",\n        coveredArea: \"\",\n        purchasingDate: \"\",\n        purchasePrice: \"\",\n        propertyOwner: \"\",\n        location: \"\",\n        id: \"\"\n      });\n    },\n    //添加家庭成员\n    addfamily: function addfamily() {\n      this.familyMembers.push({\n        appellation: \"\",\n        //称谓\n        name: \"\",\n        //姓名\n        politicsStatus: \"\",\n        //政治面貌\n        presentOccupation: \"\",\n        //现任职务\n        companyName: \"\",\n        //工作单位\n        age: \"\",\n        //年龄\n        id: \"\"\n      });\n    },\n    // 查询单位\n    initunits: function initunits() {\n      var _this3 = this;\n\n      var that = this;\n      var objs = {\n        userId: JSON.parse(localStorage.getItem(\"userinfo\")).isd\n      };\n      this.$ajax({\n        method: \"POST\",\n        url: that.globals.requesturl + \"web/office/list\",\n        data: objs,\n        headers: {\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.errorCode == \"-1\") {\n          var lists = [];\n          that.unitslist = res.data.body.officeList.map(function (list, index) {\n            return {\n              id: list.id,\n              name: list.name,\n              children: []\n            };\n          });\n        } else {\n          _this3.$message.error(res.data.msg);\n        }\n      });\n    },\n    //级联事件\n    unitChanges: function unitChanges(data) {\n      var _this4 = this;\n\n      var that = this;\n      var objs = {\n        userId: JSON.parse(localStorage.getItem(\"userinfo\")).isd,\n        parentId: data[data.length - 1]\n      };\n      this.$ajax({\n        method: \"POST\",\n        url: that.globals.requesturl + \"web/office/getChildren\",\n        data: objs,\n        headers: {\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.errorCode == \"-1\") {\n          that.showinputcompanyName = false;\n\n          if (data.length == 1) {\n            that.unitslist.map(function (list, index) {\n              if (list.id == data[0]) {\n                if (!list.children.length) {\n                  list.children = res.data.body.officeList.map(function (list, index) {\n                    return {\n                      id: list.id,\n                      name: list.name,\n                      children: list.hasChildren == false ? \"\" : []\n                    };\n                  });\n                }\n              }\n            });\n          } else if (data.length == 2) {\n            that.unitslist.map(function (list, index) {\n              if (list.id == data[0]) {\n                list.children.map(function (list, index) {\n                  if (list.id == data[1]) {\n                    if (!list.children.length) {\n                      list.children = res.data.body.officeList.map(function (list, index) {\n                        return {\n                          id: list.id,\n                          name: list.name,\n                          children: list.hasChildren == false ? \"\" : []\n                        };\n                      });\n                    }\n                  }\n                });\n              }\n            });\n          }\n        } else {\n          _this4.$message.error(res.data.msg);\n        }\n      });\n    },\n    //初始化\n    init: function init(objs) {\n      var _this5 = this;\n\n      var that = this;\n      this.$ajax({\n        method: \"POST\",\n        url: that.globals.requesturl + \"web/personnel/form\",\n        data: objs,\n        headers: {\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.errorCode == \"-1\") {\n          that.redpicimg = res.data.body.personnel.redBottomPhoto;\n          that.form = {\n            redBottomPhoto: that.globals.requesturl + res.data.body.personnel.redBottomPhoto,\n            name: res.data.body.personnel.name,\n            sex: res.data.body.personnel.sex,\n            nativePlace: res.data.body.personnel.nativePlace,\n            educationBackground: res.data.body.personnel.educationBackground,\n            nation: res.data.body.personnel.nation,\n            maritalStatus: res.data.body.personnel.maritalStatus,\n            birthday: res.data.body.personnel.birthday,\n            idCard: res.data.body.personnel.idCard,\n            politicsStatus: res.data.body.personnel.politicsStatus,\n            partyTime: res.data.body.personnel.partyTime,\n            workTime: res.data.body.personnel.workTime,\n            companyName: res.data.body.personnel.office ? res.data.body.personnel.office.name : \"\",\n            companyNameid: res.data.body.personnel.office ? res.data.body.personnel.office.id : \"\",\n            presentOccupation: res.data.body.personnel.presentOccupation,\n            jobLevel: res.data.body.personnel.jobLevel,\n            incumbentTime: res.data.body.personnel.incumbentTime,\n            personnelcategory: res.data.body.personnel.personnelcategory,\n            titleJobs: res.data.body.personnel.titleJobs,\n            titleJobsLevel: res.data.body.personnel.titleJobsLevel,\n            isCPPCCMemberOrNot: res.data.body.personnel.isCPPCCMemberOrNot,\n            isNPCDEputiesOrNot: res.data.body.personnel.isNPCDEputiesOrNot,\n            isPartyRepresentativeOrNot: res.data.body.personnel.isPartyRepresentativeOrNot,\n            // ================================================================================\n            isCommunistPartyMember: res.data.body.personnel.isCommunistPartyMember,\n            //是否市委委员\n            isCityCommissionPartyMember: res.data.body.personnel.isCityCommissionPartyMember,\n            //是否市纪委委员\n            workingState: res.data.body.personnel.workingState,\n            //在职情况\n            // ================================================================================\n            presentAddress: res.data.body.personnel.presentAddress,\n            phone: res.data.body.personnel.phone,\n            personalResume: res.data.body.personnel.personalResume,\n            rewardsAndPunishment: res.data.body.personnel.rewardsAndPunishment,\n            otherrelevantinformation: res.data.body.personnel.otherrelevantinformation,\n            id: res.data.body.personnel.id\n          };\n\n          if (res.data.body.familyMembers.length > 0) {\n            var familyarr = [];\n            res.data.body.familyMembers.map(function (list) {\n              familyarr.push({\n                id: list.id,\n                appellation: list.appellation,\n                name: list.name,\n                politicsStatus: list.politicsStatus,\n                presentOccupation: list.presentOccupation,\n                age: list.age,\n                companyName: list.officeName\n              });\n            });\n            that.familyMembers = familyarr;\n          }\n\n          if (res.data.body.housingSituations.length > 0) {\n            var housingSituations = [];\n            res.data.body.housingSituations.map(function (list) {\n              housingSituations.push({\n                id: list.id,\n                roomNumber: list.roomNumber,\n                coveredArea: list.coveredArea,\n                purchasingDate: list.purchasingDate,\n                purchasePrice: list.purchasePrice,\n                propertyOwner: list.propertyOwner,\n                location: list.location\n              });\n            });\n            that.housingSituations = housingSituations;\n          }\n        } else {\n          _this5.$message.error(res.data.msg);\n        }\n      });\n    },\n    // 表格样式的处理\n    cellStyle: function cellStyle(_ref) {\n      var row = _ref.row,\n          column = _ref.column,\n          rowIndex = _ref.rowIndex,\n          columnIndex = _ref.columnIndex;\n\n      //基数偶数延时不同\n      if (rowIndex % 2 != 0) {\n        return {\n          \"background-color\": \"#2162A8\",\n          \"text-align\": \"center\",\n          color: \"#fff\",\n          \"font-weight\": \"normal\",\n          padding: \"5px 0\",\n          height: \"60px\"\n        };\n      } else {\n        return {\n          \"background-color\": \"#02468F\",\n          \"text-align\": \"center\",\n          color: \"#fff\",\n          \"font-weight\": \"normal\",\n          height: \"60px\",\n          padding: \"5px 0\"\n        };\n      }\n    },\n    headerCellStyle: function headerCellStyle(_ref2) {\n      var row = _ref2.row,\n          rowIndex = _ref2.rowIndex;\n      return {\n        \"background-color\": \"#027DBC\",\n        \"text-align\": \"center\",\n        color: \"#fff\",\n        \"font-weight\": \"normal\",\n        height: \"60px\",\n        \"font-size\": \"16px\"\n      };\n    },\n    // 上传头像的狗子函数\n    handleAvatarSuccess: function handleAvatarSuccess(event) {\n      var that = this;\n      var files = event.target.files[0];\n      var reader = new FileReader();\n      reader.readAsDataURL(files);\n\n      reader.onload = function (e) {\n        that.form.redBottomPhoto = e.target.result;\n        var formdatas = new FormData();\n        formdatas.append('image', e.target.result);\n        that.$ajax({\n          method: \"POST\",\n          data: formdatas,\n          url: that.globals.requesturl + 'web/personnel/upload',\n          headers: {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          } // transformRequest: [function (data) { \n          //   return qs.stringify(data)\n          // }]\n\n        }).then(function (res) {\n          if (res.data.success && res.data.errorCode == '-1') {\n            that.form.redBottomPhoto = that.globals.requesturl + res.data.body.url;\n            that.redimg = res.data.body.url;\n          }\n        }, function (err) {\n          that.$message.error(\"\\u5931\\u8D25\");\n        });\n      };\n    },\n    beforeAvatarUpload: function beforeAvatarUpload(file) {\n      var isJPG = file.type === \"image/jpeg\";\n      var isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error(\"上传头像图片只能是 JPG 格式!\");\n      }\n\n      if (!isLt2M) {\n        this.$message.error(\"上传头像图片大小不能超过 2MB!\");\n      }\n\n      return isJPG && isLt2M;\n    },\n    //导出人员信息\n    exportbtns: function exportbtns() {\n      var _this6 = this;\n\n      if (this.$route.query.id == \"\") {\n        this.$message.error(\"请选择需要导出的人员\");\n      } else {\n        var obbjstr = {\n          ids: this.$route.query.id,\n          userId: JSON.parse(localStorage.getItem('userinfo')).isd\n        };\n        console.log(obbjstr);\n        this.$ajax({\n          method: \"POST\",\n          url: this.globals.requesturl + 'web/personnel/export',\n          data: obbjstr,\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          transformRequest: [function (data) {\n            return qs.stringify(data);\n          }]\n        }).then(function (res) {\n          if (res.data.errorCode == \"-1\") {\n            console.log(res.data);\n            var url = res.data.body.path;\n            var link = document.createElement('a');\n            link.style.display = 'none';\n            link.href = url;\n            link.setAttribute('download', '人员台账表');\n            document.body.appendChild(link);\n            link.click();\n\n            _this6.$message.success(res.data.msg);\n          } else {\n            _this6.$message.error(res.data.msg);\n          }\n        });\n      }\n    },\n    //返回上一页\n    goback: function goback() {\n      this.$router.go(-1);\n    }\n  },\n  watch: {}\n};",null]}