{"remainingRequest":"F:\\纪检项目\\byqc\\node_modules\\thread-loader\\dist\\cjs.js!F:\\纪检项目\\byqc\\node_modules\\babel-loader\\lib\\index.js!F:\\纪检项目\\byqc\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\纪检项目\\byqc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\纪检项目\\byqc\\src\\views\\updateprogress\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\纪检项目\\byqc\\src\\views\\updateprogress\\index.vue","mtime":1577080240117},{"path":"F:\\纪检项目\\byqc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\纪检项目\\byqc\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\纪检项目\\byqc\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\纪检项目\\byqc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\纪检项目\\byqc\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport qs from \"qs\";\nexport default {\n  name: \"StandBookEnter\",\n  inject: ['reload'],\n  data: function data() {\n    return {\n      textareaContent: \"\",\n      //文本域内容\n      bianjiid: \"\",\n      //可编辑id\n      ifupdata: \"\",\n      //是否可以修改\n      filesarr: [],\n      //上传文件name数组\n      fileList: [],\n      isdisable: false,\n      //文本域内容是否可编辑\n      id: [],\n      isShow: false,\n      //问题线索处置的子集 step=2时\n      personnelpops: false,\n      //弹框显示切换\n      bodydisponsalWay: \"\",\n      //处置方式\n      fileRecordList: [],\n      //处置方式记录附件列表\n      content: [],\n      proposedDispositionList: [],\n      //字典查询 问题线索处置的子集的\n      pages: 1,\n      step: null,\n      //进度步骤\n      nextspan: 0,\n      //下一步弹窗中span下标\n      alllistdata: [] //本地进度数据\n\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    document.title = \"线索台账修改进度\";\n    var that = this; //处置意见\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + \"web/dict\",\n      data: {\n        type: \"disponsal_way\"\n      },\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == \"-1\") {\n        that.proposedDispositionList = res.data.body.dictValueList;\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    });\n  },\n  mounted: function mounted() {\n    var id = this.$route.query.id;\n    this.init();\n    this.ifupdata = this.$route.query.ifupdata ? true : false;\n  },\n  methods: {\n    // 个人中心Tab切换\n    get: function get(e, val) {\n      if (this.ifupdata) {\n        var that = this; //从本地获取当前数据\n\n        var textlist = []; //内容数组\n\n        var preList = []; //文件数组\n\n        if (that.alllistdata.length > 0) {\n          for (var i = 0; i < that.alllistdata.length; i++) {\n            if (val == that.alllistdata[i].disponsalWay) {\n              if (that.alllistdata[i].content != \"\") {\n                textlist.push(that.alllistdata[i].content);\n              } else {\n                textlist.push(\"\");\n              }\n\n              if (that.alllistdata[i].fileRecordList.length > 0) {\n                for (var j = 0; j < that.alllistdata[i].fileRecordList.length; j++) {\n                  var lists = that.alllistdata[i].fileRecordList[j];\n                  var obj = {\n                    file: lists.file,\n                    time: lists.time\n                  };\n                  preList.push(obj);\n                }\n              } else {\n                preList.push();\n              }\n            }\n          }\n\n          that.fileRecordList = preList;\n          that.textareaContent = textlist.join(\"\\n\");\n        } //请求后台对应当前数据\n        // let objs = {\n        //   disponsalWay:val,\n        //   userId: JSON.parse(localStorage.getItem(\"userinfo\")).isd,\n        //   cluesParameterId:this.$route.query.id\n        // };\n        // this.$ajax({\n        //   method: \"POST\",\n        //   url: that.globals.requesturl + \"web/cluesparameter/details\",\n        //   data: objs,\n        //   headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n        //   transformRequest: [\n        //     function(data) {\n        //       return qs.stringify(data);\n        //     }\n        //   ]\n        // }).then(res => {\n        //   if (res.data.success && res.data.errorCode == \"-1\") {\n        //     if(res.data.body.detailList > 0){\n        //       let textlist = [];//内容数组\n        //       let arrlist = res.data.body.detailList;//返回值\n        //       let preList = [];//文件数组\n        //       for (let i = 0; i < arrlist.length; i++) {\n        //         textlist.push(arrlist[i].problemcluedisposalrecord.content);\n        //         if(arrlist[i].problemcluedisposalrecord.fileRecordList && arrlist[i].problemcluedisposalrecord.fileRecordList.length > 0){\n        //           for (let j = 0; j < arrlist[i].problemcluedisposalrecord.fileRecordList.length; j++) {\n        //             let lists = arrlist[i].problemcluedisposalrecord.fileRecordList[j];\n        //             let obj = {\n        //               file: lists.file,\n        //               time: lists.time\n        //             };\n        //             preList.push(obj);\n        //           }\n        //         }\n        //       }\n        //       that.fileRecordList = preList;\n        //       that.textareaContent = arrlist.join(\"\\n\")\n        //     }else{\n        //       that.textareaContent = \"\"\n        //       that.fileRecordList = []\n        //     }\n        //   } else {\n        //     this.$message.error(res.data.msg);\n        //   }\n        // });\n\n\n        this.pages = e; // this.isShow = e == 2 ? true : false;\n      }\n    },\n    leftget: function leftget(dex, val) {\n      if (this.ifupdata) {\n        var that = this; //从本地获取当前数据\n\n        var textlist = []; //内容数组\n\n        var preList = []; //文件数组\n\n        if (that.alllistdata.length > 0) {\n          for (var i = 0; i < that.alllistdata.length; i++) {\n            if (val == that.alllistdata[i].disponsalWay) {\n              if (that.alllistdata[i].content != \"\") {\n                textlist.push(that.alllistdata[i].content);\n              } else {\n                textlist.push(\"\");\n              }\n\n              console.log(val);\n\n              if (that.alllistdata[i].fileRecordList.length > 0) {\n                for (var j = 0; j < that.alllistdata[i].fileRecordList.length; j++) {\n                  var lists = that.alllistdata[i].fileRecordList[j];\n                  var obj = {\n                    file: lists.file,\n                    time: lists.time\n                  };\n                  preList.push(obj);\n                }\n              } else {\n                preList.push();\n              }\n            }\n          }\n\n          that.fileRecordList = preList;\n          that.textareaContent = textlist.join(\"\\n\");\n        } //请求后台对应当前数据\n        // let objs = {\n        //   disponsalWay:val,\n        //   userId: JSON.parse(localStorage.getItem(\"userinfo\")).isd,\n        //   cluesParameterId:this.$route.query.id\n        // };\n        // this.$ajax({\n        //   method: \"POST\",\n        //   url: that.globals.requesturl + \"web/cluesparameter/details\",\n        //   data: objs,\n        //   headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n        //   transformRequest: [\n        //     function(data) {\n        //       return qs.stringify(data);\n        //     }\n        //   ]\n        // }).then(res => {\n        //   if (res.data.success && res.data.errorCode == \"-1\") {\n        //     if(res.data.body.detailList.length > 0){\n        //       let textlist = [];//内容数组\n        //       let arrlist = res.data.body.detailList;//返回值\n        //       let preList = [];//文件数组\n        //       for (let i = 0; i < arrlist.length; i++) {\n        //         textlist.push(arrlist[i].problemcluedisposalrecord.content);\n        //         if(arrlist[i].problemcluedisposalrecord.fileRecordList && arrlist[i].problemcluedisposalrecord.fileRecordList.length > 0){\n        //           for (let j = 0; j < arrlist[i].problemcluedisposalrecord.fileRecordList.length; j++) {\n        //             let lists = arrlist[i].problemcluedisposalrecord.fileRecordList[j];\n        //             let obj = {\n        //               file: lists.file,\n        //               time: lists.time\n        //             };\n        //             preList.push(obj);\n        //           }\n        //         }\n        //       }\n        //       that.fileRecordList = preList;\n        //       that.textareaContent = textlist.join(\"\\n\")\n        //     }else{\n        //       that.textareaContent = \"\"\n        //       that.fileRecordList = []\n        //     }\n        //   } else {\n        //     this.$message.error(res.data.msg);\n        //   }\n        // });\n\n\n        this.step = dex;\n        this.isShow = dex == 2 ? true : false;\n      }\n    },\n    init: function init() {\n      var _this2 = this;\n\n      var that = this;\n      var objs = {\n        id: this.$route.query.id,\n        userId: JSON.parse(localStorage.getItem(\"userinfo\")).isd\n      };\n      this.$ajax({\n        method: \"POST\",\n        url: that.globals.requesturl + \"web/cluesparameter/record\",\n        data: objs,\n        headers: {\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.success && res.data.errorCode == \"-1\") {\n          that.bodydisponsalWay = res.data.body.disponsalWay == \"\" ? 0 : res.data.body.disponsalWay; //当前进度id\n\n          if (!res.data.body.disponsalWay) {\n            that.isShow = false;\n            that.step = 0;\n          } else if (res.data.body.disponsalWay == 0) {\n            that.step = 0;\n          } else if (res.data.body.disponsalWay == 1) {\n            that.step = 1;\n          } else if (res.data.body.disponsalWay == 2 || res.data.body.disponsalWay == 3 || res.data.body.disponsalWay == 4 || res.data.body.disponsalWay == 5 || res.data.body.disponsalWay == 6 || res.data.body.disponsalWay == 7 || res.data.body.disponsalWay == 8 || res.data.body.disponsalWay == 9) {\n            that.step = 2;\n            _this2.isShow = true;\n          } else if (res.data.body.disponsalWay == 10) {\n            that.step = 3;\n          } else if (res.data.body.disponsalWay == 11) {\n            that.step = 4;\n          } //新加-----\n\n\n          if (res.data.body.recordList.length > 0) {\n            var arrlist = res.data.body.recordList;\n            that.alllistdata = arrlist;\n\n            for (var i = 0; i < arrlist.length; i++) {\n              if (arrlist[i].disponsalWay == res.data.body.disponsalWay) {\n                that.textareaContent = arrlist[i].content;\n                that.bianjiid = arrlist[i].id;\n                var preList = [];\n\n                if (arrlist[i].fileRecordList.length > 0) {\n                  for (var j = 0; j < arrlist[i].fileRecordList.length; j++) {\n                    var lists = arrlist[i].fileRecordList[j];\n                    var obj = {\n                      file: lists.file,\n                      time: lists.time\n                    };\n                    preList.push(obj);\n                  }\n\n                  that.fileRecordList = preList;\n                } else {\n                  that.fileRecordList = preList;\n                }\n              }\n            }\n          } else {\n            that.textareaContent = \"\"; //textarea内容\n          } //新加-----\n\n        } else {\n          _this2.$message.error(res.data.msg);\n        }\n      });\n    },\n    //保存\n    saverecord: function saverecord() {\n      var _this3 = this;\n\n      var that = this;\n      var formdatas = new FormData();\n      formdatas.append(\"userId\", JSON.parse(localStorage.getItem(\"userinfo\")).isd);\n      formdatas.append(\"disponsalWay\", that.bodydisponsalWay);\n      formdatas.append(\"cluesParameter.id\", that.$route.query.id);\n      formdatas.append(\"content\", that.textareaContent);\n      formdatas.append(\"id\", that.bianjiid);\n\n      if (that.filesarr.length > 0) {\n        for (var i = 0; i < that.filesarr.length; i++) {\n          formdatas.append(\"files\", that.filesarr[i]);\n        }\n      }\n\n      this.$ajax({\n        method: \"post\",\n        url: this.globals.requesturl + \"web/cluesparameter/saveRecord\",\n        data: formdatas,\n        headers: {\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\n        } // transformRequest: [\n        //   function(data) {\n        //     return qs.stringify(data);\n        //   }\n        // ]\n\n      }).then(function (res) {\n        if (res.data.success && res.data.errorCode == \"-1\") {\n          _this3.fileList = [];\n\n          _this3.$message.success(res.data.msg);\n\n          _this3.personnelpops = false;\n\n          _this3.$router.push({\n            path: '/standBook'\n          });\n        } else {\n          _this3.$message.error(res.data.msg);\n        }\n      });\n    },\n    // 上传附件\n    headgetfile: function headgetfile(event) {\n      var that = this;\n      that.filesarr = event.target.files;\n      var filelist = [];\n\n      for (var key in that.filesarr) {\n        filelist.push({\n          file: that.filesarr[key].name\n        });\n      }\n\n      that.fileRecordList = filelist.splice(0, filelist.length - 2);\n    },\n    // 下一步弹窗里的确定\n    submitchangeunit: function submitchangeunit() {\n      var _this4 = this;\n\n      if (this.nextspan < 2) {\n        this.step = this.nextspan;\n        this.isShow = false;\n      } else if (this.nextspan > 9) {\n        this.step = this.nextspan == 10 ? 3 : this.nextspan == 11 ? 4 : \"\";\n        this.isShow = false;\n      } else {\n        this.step = 2;\n        this.isShow = true;\n        this.pages = this.nextspan - 1;\n      }\n\n      var that = this;\n      var formdatas = new FormData();\n      formdatas.append(\"userId\", JSON.parse(localStorage.getItem(\"userinfo\")).isd);\n      formdatas.append(\"disponsalWay\", that.bodydisponsalWay);\n      formdatas.append(\"cluesParameter.id\", that.$route.query.id);\n      formdatas.append(\"content\", that.textareaContent);\n      formdatas.append(\"dw\", that.proposedDispositionList[that.nextspan].value);\n      formdatas.append(\"id\", that.bianjiid);\n\n      if (that.filesarr.length > 0) {\n        for (var i = 0; i < that.filesarr.length; i++) {\n          formdatas.append(\"files\", that.filesarr[i]);\n        }\n      }\n\n      this.$ajax({\n        method: \"post\",\n        url: this.globals.requesturl + \"web/cluesparameter/saveRecord\",\n        data: formdatas,\n        headers: {\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\n        } // transformRequest: [\n        //   function(data) {\n        //     return qs.stringify(data);\n        //   }\n        // ]\n\n      }).then(function (res) {\n        if (res.data.success && res.data.errorCode == \"-1\") {\n          _this4.fileList = [];\n\n          _this4.$message.success(res.data.msg);\n\n          _this4.personnelpops = false;\n\n          _this4.reload();\n        } else {\n          _this4.$message.error(res.data.msg);\n        }\n      });\n    }\n  }\n};",null]}