{"remainingRequest":"D:\\我的项目\\纪检委\\byqc\\node_modules\\thread-loader\\dist\\cjs.js!D:\\我的项目\\纪检委\\byqc\\node_modules\\babel-loader\\lib\\index.js!D:\\我的项目\\纪检委\\byqc\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\我的项目\\纪检委\\byqc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\我的项目\\纪检委\\byqc\\src\\views\\ProblemStandBookEnter\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\我的项目\\纪检委\\byqc\\src\\views\\ProblemStandBookEnter\\index.vue","mtime":1576827060660},{"path":"D:\\我的项目\\纪检委\\byqc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检委\\byqc\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检委\\byqc\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检委\\byqc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检委\\byqc\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport qs from 'qs';\nimport Breadcrumb from \"@/components/Breadcrumb\";\nexport default {\n  name: \"ProblemStandBookEnter\",\n  data: function data() {\n    return {\n      disabled: false,\n      showinput: false,\n      //单位名称框显示\n      inputcompanyName: \"\",\n      //单位名称 只做显示\n      itemid: \"\",\n      form: {\n        name: \"\",\n        companyName: \"\",\n        companyLevel: \"\",\n        duty: \"\",\n        jobLevel: \"\",\n        time: \"\",\n        problemSources: \"\",\n        problemType: \"\",\n        problemKind: \"\",\n        disposalOpinion: \"\",\n        processingTime: \"\",\n        abarbeitungTime: \"\",\n        abarbeitungSituation: \"\",\n        problemDigest: \"\",\n        handlingInformation: \"\",\n        effectRectification: \"\",\n        remarks: \"\",\n        'companyName.id': \"\"\n      },\n      rules: {\n        name: [{\n          required: true,\n          message: '请输入姓名',\n          trigger: 'blur'\n        }],\n        companyName: [{\n          required: true,\n          message: '请选择单位',\n          trigger: 'blur'\n        }],\n        companyLevel: [{\n          required: true,\n          message: '请选择单位级别',\n          trigger: 'blur'\n        }],\n        duty: [{\n          required: true,\n          message: '请填写职务',\n          trigger: 'blur'\n        }],\n        jobLevel: [{\n          required: true,\n          message: '请选择职务级别',\n          trigger: 'blur'\n        }],\n        time: [{\n          required: true,\n          message: '请选择时间',\n          trigger: 'blur'\n        }],\n        problemSources: [{\n          required: true,\n          message: '请选择问题来源',\n          trigger: 'blur'\n        }],\n        problemType: [{\n          required: true,\n          message: '请选择问题类型',\n          trigger: 'blur'\n        }],\n        problemKind: [{\n          required: true,\n          message: '请选择问题类型',\n          trigger: 'blur'\n        }],\n        disposalOpinion: [{\n          required: true,\n          message: '请选择处置意见',\n          trigger: 'blur'\n        }],\n        processingTime: [{\n          required: true,\n          message: '请选择处理时间',\n          trigger: 'blur'\n        }],\n        abarbeitungTime: [{\n          required: true,\n          message: '请选择整改时间',\n          trigger: 'blur'\n        }],\n        abarbeitungSituation: [{\n          required: true,\n          message: '请选择整改情况',\n          trigger: 'blur'\n        }]\n      },\n      //级联选择\n      unitslist: [],\n      //单位级别\n      unitRankList: [],\n      //职务级别\n      dutyRankList: [],\n      //问题来源\n      proFromList: [],\n      //问题类型\n      proTypeList: [],\n      //问题种类\n      proVarietyList: [],\n      //处置意见\n      disposeIdeaList: [],\n      //整改情况\n      reformStatusList: []\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    document.title = \"线索台账录入\";\n    var that = this; //问题来源\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + 'web/dict',\n      data: {\n        type: 'problem_sources'\n      },\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == '-1') {\n        res.data.body.dictValueList.map(function (list) {\n          that.proFromList.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //职务级别\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + 'web/dict',\n      data: {\n        type: 'job_level'\n      },\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == '-1') {\n        res.data.body.dictValueList.map(function (list) {\n          that.dutyRankList.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //单位级别\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + 'web/dict',\n      data: {\n        type: 'company_level'\n      },\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == '-1') {\n        res.data.body.dictValueList.map(function (list) {\n          that.unitRankList.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //问题类型\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + 'web/dict',\n      data: {\n        type: 'problem_type'\n      },\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == '-1') {\n        res.data.body.dictValueList.map(function (list) {\n          that.proTypeList.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //问题种类\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + 'web/dict',\n      data: {\n        type: 'problem_kind'\n      },\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == '-1') {\n        res.data.body.dictValueList.map(function (list) {\n          that.proVarietyList.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //处置意见\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + 'web/dict',\n      data: {\n        type: 'disposal_opinion'\n      },\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == '-1') {\n        res.data.body.dictValueList.map(function (list) {\n          that.disposeIdeaList.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    }); //整改情况\n\n    this.$ajax({\n      method: \"POST\",\n      url: this.globals.requesturl + 'web/dict',\n      data: {\n        type: 'abarbeitung_situation'\n      },\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      transformRequest: [function (data) {\n        return qs.stringify(data);\n      }]\n    }).then(function (res) {\n      if (res.data.success && res.data.errorCode == '-1') {\n        res.data.body.dictValueList.map(function (list) {\n          that.reformStatusList.push({\n            value: list.value,\n            label: list.label\n          });\n        });\n      } else {\n        _this.$message.error(res.data.msg);\n      }\n    });\n  },\n  mounted: function mounted() {\n    var id = this.$route.query.id;\n\n    if (id) {\n      this.showinput = true;\n      this.itemid = id;\n      var objs = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd,\n        id: id\n      };\n      this.init(objs);\n    }\n\n    this.initunits();\n  },\n  methods: {\n    //页面初始化\n    init: function init(objs) {\n      var _this2 = this;\n\n      var that = this;\n      this.$ajax({\n        method: \"POST\",\n        url: that.globals.requesturl + 'web/problemsofparameter/form',\n        data: objs,\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.success && res.data.errorCode == '-1') {\n          that.inputcompanyName = res.data.body.companyName.name;\n          that.form.name = res.data.body.name;\n          that.form.effectRectification = res.data.body.effectRectification;\n          that.form.handlingInformation = res.data.body.handlingInformation;\n          that.form.problemDigest = res.data.body.problemDigest;\n          that.form.companyName = res.data.body.companyName.name;\n          that.form.duty = res.data.body.duty;\n          that.form.time = res.data.body.time;\n          that.form.processingTime = res.data.body.processingTime;\n          that.form.abarbeitungTime = res.data.body.abarbeitungTime;\n          that.form.remarks = res.data.body.remarks;\n          that.dutyRankList.map(function (list) {\n            if (list.value == res.data.body.jobLevel) {\n              that.form.jobLevel = list.label;\n            }\n          });\n          that.disposeIdeaList.map(function (list) {\n            if (list.value == res.data.body.disposalOpinion) {\n              that.form.disposalOpinion = list.label;\n            }\n          });\n          that.reformStatusList.map(function (list) {\n            if (list.value == res.data.body.abarbeitungSituation) {\n              that.form.abarbeitungSituation = list.label;\n            }\n          });\n          that.proVarietyList.map(function (list) {\n            if (list.value == res.data.body.problemKind) {\n              that.form.problemKind = list.label;\n            }\n          });\n          that.proFromList.map(function (list) {\n            if (list.value == res.data.body.problemSources) {\n              that.form.problemSources = list.label;\n            }\n          });\n          that.proTypeList.map(function (list) {\n            if (list.value == res.data.body.problemType) {\n              that.form.problemType = list.label;\n            }\n          });\n          that.unitRankList.map(function (list) {\n            if (list.value == res.data.body.companyLevel) {\n              that.form.companyLevel = list.label;\n            }\n          });\n        } else {\n          _this2.$message.error(res.data.msg);\n        }\n      });\n    },\n    // 查询单位\n    initunits: function initunits() {\n      var _this3 = this;\n\n      var that = this;\n      var objs = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd\n      };\n      this.$ajax({\n        method: \"POST\",\n        url: that.globals.requesturl + 'web/office/list',\n        data: objs,\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.errorCode == \"-1\") {\n          var lists = [];\n          that.unitslist = res.data.body.officeList.map(function (list, index) {\n            return {\n              id: list.id,\n              name: list.name,\n              children: []\n            };\n          });\n        } else {\n          _this3.$message.error(res.data.msg);\n        }\n      });\n    },\n    //级联事件\n    unitChanges: function unitChanges(data) {\n      var _this4 = this;\n\n      var that = this;\n      var objs = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd,\n        parentId: data[data.length - 1]\n      };\n      this.$ajax({\n        method: \"POST\",\n        url: that.globals.requesturl + 'web/office/getChildren',\n        data: objs,\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.errorCode == \"-1\") {\n          if (data.length == 1) {\n            that.unitslist.map(function (list, index) {\n              if (list.id == data[0]) {\n                if (!list.children.length) {\n                  list.children = res.data.body.officeList.map(function (list, index) {\n                    return {\n                      id: list.id,\n                      name: list.name,\n                      children: list.hasChildren == false ? \"\" : []\n                    };\n                  });\n                }\n              }\n            });\n          } else if (data.length == 2) {\n            that.unitslist.map(function (list, index) {\n              if (list.id == data[0]) {\n                list.children.map(function (list, index) {\n                  if (list.id == data[1]) {\n                    if (!list.children.length) {\n                      list.children = res.data.body.officeList.map(function (list, index) {\n                        return {\n                          id: list.id,\n                          name: list.name,\n                          children: list.hasChildren == false ? \"\" : []\n                        };\n                      });\n                    }\n                  }\n                });\n              }\n            });\n          }\n        } else {\n          _this4.$message.error(res.data.msg);\n        }\n      });\n    },\n    //保存\n    savebtns: function savebtns(formName) {\n      var _this5 = this;\n\n      var that = this;\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          var requestform = {\n            id: that.itemid,\n            name: that.form.name,\n            companyLevel: that.form.companyLevel,\n            duty: that.form.duty,\n            jobLevel: that.form.jobLevel,\n            time: that.form.time,\n            problemSources: that.form.problemSources,\n            problemType: that.form.problemType,\n            problemKind: that.form.problemKind,\n            disposalOpinion: that.form.disposalOpinion,\n            processingTime: that.form.processingTime,\n            abarbeitungTime: that.form.abarbeitungTime,\n            abarbeitungSituation: that.form.abarbeitungSituation,\n            problemDigest: that.form.problemDigest,\n            handlingInformation: that.form.handlingInformation,\n            effectRectification: that.form.effectRectification,\n            remarks: that.form.remarks,\n            'companyName.id': that.form.companyName[that.form.companyName.length - 1],\n            userId: JSON.parse(localStorage.getItem('userinfo')).isd\n          };\n\n          _this5.$ajax({\n            method: \"POST\",\n            url: that.globals.requesturl + 'web/problemsofparameter/save',\n            data: requestform,\n            headers: {\n              'Content-Type': 'application/x-www-form-urlencoded'\n            },\n            transformRequest: [function (data) {\n              return qs.stringify(data);\n            }]\n          }).then(function (res) {\n            if (res.data.errorCode == \"-1\") {\n              _this5.$message.success(res.data.msg);\n\n              _this5.$router.go(-1);\n            } else {\n              _this5.$message.error(res.data.msg);\n            }\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    //返回上一页\n    goback: function goback() {\n      this.$router.go(-1);\n    }\n  },\n  components: {// Breadcrumb\n  }\n};",null]}