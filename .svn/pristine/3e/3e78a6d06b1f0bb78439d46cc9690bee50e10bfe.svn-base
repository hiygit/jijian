{"remainingRequest":"D:\\我的项目\\纪检委\\byqc\\node_modules\\thread-loader\\dist\\cjs.js!D:\\我的项目\\纪检委\\byqc\\node_modules\\babel-loader\\lib\\index.js!D:\\我的项目\\纪检委\\byqc\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\我的项目\\纪检委\\byqc\\src\\views\\StandingBook\\script.js?vue&type=script&lang=js&","dependencies":[{"path":"D:\\我的项目\\纪检委\\byqc\\src\\views\\StandingBook\\script.js","mtime":1576757333666},{"path":"D:\\我的项目\\纪检委\\byqc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检委\\byqc\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检委\\byqc\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\我的项目\\纪检委\\byqc\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport Navbar from '@/components/Navbar/index.vue';\nimport qs from 'qs';\nexport default {\n  name: 'StandingBook',\n  components: {\n    Navbar: Navbar\n  },\n  data: function data() {\n    return {\n      unittitles: \"\",\n      //单位详情标题\n      remarks: \"\",\n      //单位详情介绍\n      headpic: \"\",\n      messages: \"\",\n      //初始化信息\n      info: true,\n      //初始化\n      isfullscreen: false,\n      //是否全屏显示\n      ifshowpop: false,\n      //是否显示弹框\n      companydata: [],\n      //搜索\n      formInline: {\n        keywords: \"\",\n        user: \"\"\n      },\n      ifnounits: false,\n      //是否显示人员信息\n      iscol1: false,\n      iscol2: false,\n      iscol3: false,\n      iscol4: false,\n      issearch: false,\n      //是否显示根据关键字和名字查询人员信息\n      issearchlist1: false,\n      issearchlist2: false,\n      //单位\n      units: [],\n      //部门\n      section: [],\n      //人员\n      staff: [],\n      //人员类别项\n      humanitem: [],\n      exportids: \"\" //\n\n    };\n  },\n  created: function created() {\n    document.title = \"人员台账\";\n  },\n  mounted: function mounted() {\n    this.init();\n    this.leftunit();\n  },\n  methods: {\n    //初始化\n    init: function init() {\n      var _this = this;\n\n      var that = this;\n      var objs = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd,\n        officeId: \"\"\n      };\n      this.$ajax({\n        method: \"POST\",\n        url: that.globals.requesturl + 'web/personnel/index',\n        data: objs,\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.errorCode == \"-1\") {\n          that.messages = res.data.msg;\n        } else {\n          _this.$message.error(res.data.msg);\n        }\n      });\n    },\n    //获取左边单位\n    leftunit: function leftunit() {\n      var _this2 = this;\n\n      var that = this;\n      var objs = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd\n      };\n      this.$ajax({\n        method: \"POST\",\n        url: this.globals.requesturl + 'web/office/list',\n        data: objs,\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.errorCode == \"-1\") {\n          res.data.body.officeList.map(function (list) {\n            list.checkedstate = false;\n          });\n          that.companydata = res.data.body.officeList;\n        } else {\n          _this2.$message.error(res.data.msg);\n        }\n      });\n    },\n    // 选择单位\n    selectitem: function selectitem(dex) {\n      var _this3 = this;\n\n      this.companydata.map(function (list) {\n        list.checkedstate = false;\n      });\n      this.companydata[dex].checkedstate = true;\n      this.info = false;\n      this.ifnounits = true;\n      this.iscol1 = true;\n      this.iscol2 = false;\n      this.iscol3 = false;\n      this.iscol4 = false;\n      this.issearch = false;\n      this.issearchlist1 = false;\n      this.issearchlist2 = false;\n      var requestobj = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd,\n        officeId: this.companydata[dex].id\n      };\n      this.$ajax({\n        method: \"POST\",\n        url: this.globals.requesturl + 'web/personnel/index',\n        data: requestobj,\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.errorCode == \"-1\") {\n          res.data.body.offices.map(function (list) {\n            list.checkedstate = false;\n          });\n          _this3.units = res.data.body.offices;\n        } else {\n          _this3.$message.error(res.data.msg);\n        }\n      });\n    },\n    //机关\n    selunits: function selunits(dex) {\n      var _this4 = this;\n\n      this.units.map(function (list) {\n        list.checkedstate = false;\n      });\n      this.units[dex].checkedstate = true;\n\n      if (this.units[dex].hasChildren) {\n        this.iscol2 = true;\n        this.iscol3 = false;\n      } else {\n        this.iscol2 = false;\n        this.iscol3 = true;\n      }\n\n      this.iscol4 = false;\n      var requestobj = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd,\n        officeId: this.units[dex].id\n      };\n      this.$ajax({\n        method: \"POST\",\n        url: this.globals.requesturl + 'web/personnel/index',\n        data: requestobj,\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.errorCode == \"-1\") {\n          if (_this4.units[dex].hasChildren) {\n            res.data.body.offices.map(function (list) {\n              list.checkedstate = false;\n            });\n            _this4.section = res.data.body.offices;\n          } else {\n            res.data.body.personnels.map(function (list) {\n              list.checkedstate = false;\n            });\n            _this4.staff = res.data.body.personnels;\n          }\n        } else {\n          _this4.$message.error(res.data.msg);\n        }\n      });\n    },\n    //部门\n    selsection: function selsection(dex) {\n      var _this5 = this;\n\n      this.section.map(function (list) {\n        list.checkedstate = false;\n      });\n      this.section[dex].checkedstate = true;\n      this.iscol3 = true;\n      this.iscol4 = false;\n      var requestobj = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd,\n        officeId: this.section[dex].id\n      };\n      this.$ajax({\n        method: \"POST\",\n        url: this.globals.requesturl + 'web/personnel/index',\n        data: requestobj,\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.errorCode == \"-1\") {\n          if (_this5.section[dex].hasChildren) {// res.data.body.offices.map(function(list){\n            //   list.checkedstate = false\n            // })\n            // this.section = res.data.body.offices\n          } else {\n            res.data.body.personnels.map(function (list) {\n              list.checkedstate = false;\n            });\n            _this5.staff = res.data.body.personnels;\n          }\n        } else {\n          _this5.$message.error(res.data.msg);\n        }\n      });\n    },\n    //人员\n    selstaff: function selstaff(dex, items) {\n      this.searchprople(items.id);\n      this.staff.map(function (list) {\n        list.checkedstate = false;\n      });\n      this.headpic = this.globals.requesturl + items.redBottomPhoto;\n      this.staff[dex].checkedstate = true;\n      this.iscol4 = true;\n    },\n    //长按事件\n    showDeleteButton: function showDeleteButton(id) {\n      var _this6 = this;\n\n      var that = this;\n      var querstobj = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd,\n        id: id\n      };\n      this.$ajax({\n        method: \"POST\",\n        data: querstobj,\n        url: this.globals.requesturl + 'web/office/getRemarks',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.success && res.data.errorCode == -1) {\n          console.log(res.data);\n          that.unittitles = res.data.body.title; // let str = res.data.body.remarks.replace(/\\n/g,\"<br/>\")\n\n          that.remarks = res.data.body.content.replace(/\\n/g, \"<br/>\");\n        } else {\n          _this6.$message.error(res.data.msg);\n        }\n      });\n      this.ifshowpop = true;\n    },\n    // 页面跳转\n    goLink: function goLink(e) {\n      this.$router.push({\n        path: e\n      });\n    },\n    //关闭弹框\n    closepop: function closepop() {\n      this.ifshowpop = false;\n      this.isfullscreen = false;\n    },\n    //查询按钮\n    searchbtn: function searchbtn() {\n      var _this7 = this;\n\n      var querstobj = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd,\n        keyword: this.formInline.keywords,\n        name: this.formInline.user\n      };\n      this.$ajax({\n        method: \"POST\",\n        data: querstobj,\n        url: this.globals.requesturl + 'web/personnel/solrSelect',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.success && res.data.errorCode == -1) {\n          var listarr = [];\n\n          for (var i = 0; i < res.data.body.list.length; i++) {\n            for (var j = 0; j < res.data.body.list[i].personnelList.length; j++) {\n              var list = res.data.body.list[i].personnelList[j];\n              listarr.push({\n                checkedstate: false,\n                names: list.name,\n                offics: list.office.name,\n                headimg: _this7.globals.requesturl + list.redBottomPhoto,\n                id: list.id\n              });\n            }\n          }\n\n          _this7.staff = listarr;\n        } else {\n          _this7.$message.error(res.data.msg);\n        }\n      });\n      this.info = false;\n      this.issearch = true;\n      this.ifnounits = false;\n      this.iscol1 = false;\n      this.iscol2 = false;\n      this.iscol3 = false;\n      this.iscol4 = false;\n      this.issearchlist1 = true;\n      this.issearchlist2 = false;\n    },\n    // 根据关键字和名字查询人员信息点击\n    searchprople: function searchprople(id) {\n      var _this8 = this;\n\n      var that = this;\n      that.exportids = id;\n      var objpeople = {\n        userId: JSON.parse(localStorage.getItem('userinfo')).isd,\n        personnelId: id\n      };\n      this.$ajax({\n        method: \"POST\",\n        data: objpeople,\n        url: that.globals.requesturl + 'web/personnel/indexPersonnel',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        transformRequest: [function (data) {\n          return qs.stringify(data);\n        }]\n      }).then(function (res) {\n        if (res.data.success && res.data.errorCode == -1) {\n          var arrlist = [];\n          res.data.body.list.map(function (list) {\n            switch (list.name) {\n              case '谈话情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/tanhua.png\"),\n                  selimg: require(\"@/assets/issue/tanhua1.png\")\n                });\n                break;\n\n              case '函询情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/hanxun.png\"),\n                  selimg: require(\"@/assets/issue/hanxun1.png\")\n                });\n                break;\n\n              case '谈话+函询情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/tanhan.png\"),\n                  selimg: require(\"@/assets/issue/tanhan1.png\")\n                });\n                break;\n\n              case '初核情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/chuhe.png\"),\n                  selimg: require(\"@/assets/issue/chuhe1.png\")\n                });\n                break;\n\n              case '暂存情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/zancun.png\"),\n                  selimg: require(\"@/assets/issue/zancun1.png\")\n                });\n                break;\n\n              case '拟立案情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/lian.png\"),\n                  selimg: require(\"@/assets/issue/lian1.png\")\n                });\n                break;\n\n              case '了结情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/lejie.png\"),\n                  selimg: require(\"@/assets/issue/lejie1.png\")\n                });\n                break;\n\n              case '转办情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/zhunaban.png\"),\n                  selimg: require(\"@/assets/issue/zhunaban1.png\")\n                });\n                break;\n\n              case '党纪处分情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/dangji.png\"),\n                  selimg: require(\"@/assets/issue/dangji1.png\")\n                });\n                break;\n\n              case '党组织党纪处分情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/dangzu.png\"),\n                  selimg: require(\"@/assets/issue/dangzu1.png\")\n                });\n                break;\n\n              case '批评教育情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/piping.png\"),\n                  selimg: require(\"@/assets/issue/piping1.png\")\n                });\n                break;\n\n              case '组织处理情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/zuzhi.png\"),\n                  selimg: require(\"@/assets/issue/zuzhi1.png\")\n                });\n                break;\n\n              case '政务处分情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/zhengwu.png\"),\n                  selimg: require(\"@/assets/issue/zhengwu1.png\")\n                });\n                break;\n\n              case '其他情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/qita.png\"),\n                  selimg: require(\"@/assets/issue/qita1.png\")\n                });\n                break;\n\n              case '问责情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/wenze.png\"),\n                  selimg: require(\"@/assets/issue/wenze1.png\")\n                });\n                break;\n\n              case '民主生活会情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/minzhu.png\"),\n                  selimg: require(\"@/assets/issue/minzhu1.png\")\n                });\n                break;\n\n              case '任职变动情况':\n                arrlist.push({\n                  title: list.name,\n                  num: list.number,\n                  imgs: require(\"@/assets/issue/renzhi.png\"),\n                  selimg: require(\"@/assets/issue/renzhi1.png\")\n                });\n                break;\n            }\n\n            that.humanitem = arrlist;\n          });\n        } else {\n          _this8.$message.error(res.data.msg);\n        }\n      });\n    },\n    searchresultsitem: function searchresultsitem(dex, item) {\n      this.searchprople(item.id);\n      this.staff.map(function (list) {\n        list.checkedstate = false;\n      });\n      this.headpic = item.headimg;\n      this.staff[dex].checkedstate = true;\n      this.issearchlist2 = true;\n    },\n    //导出人员信息\n    exportbtns: function exportbtns() {\n      var _this9 = this;\n\n      if (this.exportids == \"\") {\n        this.$message.error(\"请选择需要导出的人员\");\n      } else {\n        var obbjstr = {\n          ids: this.exportids,\n          userId: JSON.parse(localStorage.getItem('userinfo')).isd\n        };\n        this.$ajax({\n          method: \"POST\",\n          url: this.globals.requesturl + 'web/personnel/export',\n          data: obbjstr,\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          transformRequest: [function (data) {\n            return qs.stringify(data);\n          }]\n        }).then(function (res) {\n          if (res.data.errorCode == \"-1\") {\n            var url = res.data.body.path;\n            var link = document.createElement('a');\n            link.style.display = 'none';\n            link.href = url;\n            link.setAttribute('download', '人员台账表');\n            document.body.appendChild(link);\n            link.click();\n\n            _this9.$message.success(res.data.msg);\n          } else {\n            _this9.$message.error(res.data.msg);\n          }\n        });\n      }\n    }\n  },\n  watch: {\n    companydata: {\n      handler: function handler(newVal, oldVal) {\n        var _this10 = this;\n\n        this.checkedall = true;\n        this.companydata.map(function (item) {\n          if (!item.checkedstate) {\n            _this10.checkedall = false;\n          }\n        });\n      },\n      deep: true\n    }\n  }\n};",null]}